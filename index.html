<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>GunkyZone</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link href="https://fonts.googleapis.com/css2?family=VT323&family=Share+Tech+Mono&family=IM+Fell+English:ital@0;1&display=swap" rel="stylesheet">
  <style>
    *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
    :root {
      --bg:        #060606;
      --bg2:       #0d0d0d;
      --bg3:       #131313;
      --border:    #2a1a1a;
      --dim:       #5a3a3a;
      --text:      #d4c0c0;
      --accent:    #9b0000;
      --accent2:   #cc0000;
      --glow:      rgba(155, 0, 0, 0.22);
      --font-mono: 'Share Tech Mono', monospace;
      --font-disp: 'VT323', monospace;
      --font-body: 'IM Fell English', serif;
    }

    html { scroll-behavior: smooth; scrollbar-gutter: stable; }
    body {
      background: var(--bg); color: var(--text);
      font-family: var(--font-mono); font-size: 15px;
      line-height: 1.7; min-height: 100vh; overflow-x: hidden;
      overflow-y: scroll;
    }
    body::before {
      content: ''; position: fixed; inset: 0;
      background: repeating-linear-gradient(to bottom, transparent 0px, transparent 2px, rgba(0,0,0,0.18) 2px, rgba(0,0,0,0.18) 4px);
      pointer-events: none; z-index: 1000;
    }
    body::after {
      content: ''; position: fixed; inset: 0;
      background: radial-gradient(ellipse at center, transparent 55%, rgba(0,0,0,0.6) 100%);
      pointer-events: none; z-index: 999;
    }

    a { color: var(--accent); text-decoration: none; }
    a:hover { text-decoration: underline; color: var(--accent2); }

    .site-wrapper {
      max-width: 860px; margin: 0 auto; padding: 0 20px;
    }

    @keyframes crtBoot {
      0% {
        filter: blur(2px) brightness(1.2);
        opacity: 1;
      }
      20% {
        filter: blur(1px) brightness(1.1);
        opacity: 1;
      }
      40% {
        filter: blur(0px) brightness(1);
        opacity: 0.95;
        clip-path: inset(50% 0 50% 0);
      }
      70% {
        opacity: 0.98;
        clip-path: inset(0 0 0 0);
      }
      100% {
        opacity: 1;
        clip-path: inset(0 0 0 0);
      }
    }

    body {
      animation: crtBoot 1s cubic-bezier(0.34, 1.56, 0.64, 1);
    }

    header { border-bottom: 1px solid var(--border); padding: 48px 0 32px; }
    .header-tag { font-size: 11px; color: var(--dim); letter-spacing: 3px; text-transform: uppercase; margin-bottom: 12px; }
    .site-title {
      font-family: var(--font-disp); font-size: clamp(52px, 9vw, 90px);
      line-height: 1; color: var(--accent); text-shadow: 0 0 40px var(--glow); letter-spacing: 2px;
    }
    .site-title span { color: var(--accent2); }
    .cursor {
      display: inline-block; width: 2px; height: 0.85em;
      background: var(--accent); vertical-align: middle; margin-left: 4px;
      animation: blink 1.1s step-end infinite;
    }
    @keyframes blink { 50% { opacity: 0; } }
    .site-subtitle { font-family: var(--font-body); font-style: italic; color: var(--dim); font-size: 14px; margin-top: 10px; }

    nav { display: flex; margin-top: 28px; border: 1px solid var(--border); width: fit-content; }
    nav a {
      display: block; padding: 7px 18px; color: var(--dim);
      font-size: 13px; letter-spacing: 1.5px; text-transform: uppercase;
      border-right: 1px solid var(--border); transition: all 0.15s;
    }
    nav a:last-child { border-right: none; }
    nav a:hover { background: var(--bg3); color: var(--accent); text-decoration: none; }
    nav a.active { background: var(--bg3); color: var(--accent); }

    main { padding: 40px 0 80px; }

    .welcome-box {
      border: 1px solid var(--border);
      padding: 24px 28px;
      background: linear-gradient(180deg, var(--bg2), #0b0b0b);
      margin-bottom: 36px;
      position: relative;
      box-shadow: 0 8px 30px rgba(0,0,0,0.45);
      border-radius: 6px;
    }
    .welcome-box::before {
      content: '//';
      position: absolute;
      top: -1px; left: 16px;
      background: var(--bg2);
      padding: 0 6px;
      font-size: 11px;
      color: var(--accent);
    }
    .welcome-box p {
      font-family: var(--font-body);
      font-size: 15px;
      color: var(--text);
      line-height: 1.9;
    }

    .section-label {
      font-size: 10px;
      letter-spacing: 3px;
      text-transform: uppercase;
      color: var(--dim);
      margin-bottom: 16px;
      display: flex;
      align-items: center;
      gap: 10px;
    }
    .section-label::after {
      content: '';
      flex: 1;
      height: 1px;
      background: var(--border);
    }

    .chat-wrap {
      max-width: 680px;
      overflow: hidden;
    }

    .chat-wrap iframe {
      display: block;
      width: 100%;
      height: 700px;
      border: none;
      background: #060606;
      scrollbar-width: none;
    }

    .chat-wrap iframe::-webkit-scrollbar {
      display: none;
    }

    footer {
      border-top: 1px solid var(--border); padding: 24px 0;
      display: flex; justify-content: space-between; align-items: center;
      font-size: 11px; color: var(--dim);
    }
    .footer-badges { display: flex; gap: 8px; }
    .badge {
      display: inline-block; border: 1px solid var(--border);
      padding: 3px 8px; font-size: 10px; color: var(--dim);
      letter-spacing: 1px; text-transform: uppercase;
    }

    .recent-section {
      margin-top: 40px;
    }

    .recent-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
      gap: 16px;
      margin-top: 16px;
    }

    .recent-item {
      border: 1px solid var(--border);
      padding: 12px;
      background: var(--bg2);
      border-radius: 6px;
      text-align: center;
      transition: all 0.2s;
    }

    .recent-item:hover {
      background: var(--bg3);
      border-color: var(--accent);
    }

    .recent-item p {
      font-size: 12px;
      color: var(--accent);
      margin-bottom: 8px;
      text-transform: uppercase;
      letter-spacing: 1px;
    }

    .recent-item a {
      display: inline-block;
      padding: 8px 16px;
      border: 1px solid var(--border);
      background: var(--bg3);
      color: var(--accent);
      border-radius: 4px;
      font-size: 12px;
      transition: all 0.2s;
    }

    .recent-item a:hover {
      background: var(--accent);
      color: var(--bg);
      text-decoration: none;
    }
  </style>
</head>
<body>
<div class="site-wrapper">

  <header>
    <div class="header-tag">est. 2025</div>
    <h1 class="site-title">GUNKY<span>ZONE</span><span class="cursor"></span></h1>
    <p class="site-subtitle">comics · stories · dispatches from somewhere</p>
    <nav>
      <a href="index.html" class="active">home</a>
      <a href="comics.html">comics</a>
      <a href="drawings.html">drawings</a>
      <a href="chat-github.html">chat</a>
      <a href="about.html">about</a>
    </nav>
  </header>

  <main>
    <div class="welcome-box">
      <p>
        Welcome to the GunkyZone. This is a personal site where I share my thoughts, 
        creations, and the weird stuff I find interesting. Feel free to explore, 
        drop a message in the chat, or just lurk around.
      </p>
    </div>

    <div class="section-label">Recent Comics</div>
    <div id="recent-comics"></div>

    <div class="section-label">Recent Drawings</div>
    <div id="recent-drawings"></div>

    <div class="section-label">Live Chat</div>
    <div class="chat-wrap">
      <iframe
        src="chat-github.html?chat-only"
        title="GunkyZone chat"
        loading="lazy"
        referrerpolicy="no-referrer-when-downgrade"
        sandbox="allow-same-origin allow-scripts allow-popups allow-forms">
      </iframe>
    </div>

    <div id="comic-modal" style="display: none; position: fixed; inset: 0; background: rgba(0,0,0,0.95); z-index: 10000; padding: 20px;">
      <button onclick="closeComicModal()" style="position: absolute; top: 20px; right: 20px; padding: 10px 20px; background: #9b0000; color: white; border: none; cursor: pointer; border-radius: 4px; font-family: 'Share Tech Mono', monospace;">Close</button>
      <iframe id="comic-iframe" style="width: 100%; height: calc(100% - 60px); border: none; border-radius: 4px;" src=""></iframe>
    </div>
  </main>

  <footer>
    <span>© 2025 gunkyzone · made with hand-typed html</span>
    <div class="footer-badges">
      <span class="badge">hosted on github</span>
      <span class="badge">firebase</span>
    </div>
  </footer>

</div>
</body>
</html>

<script>
  // Firebase config
  window.FIREBASE_CONFIG = {
    apiKey: "AIzaSyD1L4Mmgnbl0W7lk1rnaRu5wv61TSFhJqM",
    authDomain: "gunkychat.firebaseapp.com",
    databaseURL: "https://gunkychat-default-rtdb.firebaseio.com",
    projectId: "gunkychat",
    storageBucket: "gunkychat.firebasestorage.app",
    messagingSenderId: "423489767287",
    appId: "1:423489767287:web:ce847768781b0f589dc372",
    measurementId: "G-W7VBG0GSV9"
  };

  function loadSiteContent() {
    function loadScript(src, cb) {
      var s = document.createElement('script');
      s.src = src;
      s.onload = cb;
      s.onerror = function() {
        console.warn('Failed to load Firebase');
      };
      s.async = true;
      document.head.appendChild(s);
    }

    loadScript('https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js', function() {
      loadScript('https://www.gstatic.com/firebasejs/9.22.2/firebase-database-compat.js', function() {
        try {
          firebase.initializeApp(window.FIREBASE_CONFIG);
          var contentRef = firebase.database().ref('/site_content');
          
          contentRef.once('value', function(snap) {
            var data = snap.val() || {};
            
            // Update subtitle
            if (data.subtitle) {
              var subtitleEl = document.querySelector('.site-subtitle');
              if (subtitleEl) subtitleEl.textContent = data.subtitle;
            }
            
            // Update welcome text
            if (data.welcomeText) {
              var welcomeEl = document.querySelector('.welcome-box p');
              if (welcomeEl) welcomeEl.textContent = data.welcomeText;
            }
            
            // Update chat label
            if (data.chatLabel) {
              var labelEl = document.querySelector('.section-label');
              if (labelEl) labelEl.textContent = data.chatLabel;
            }
            
            // Update footer text
            if (data.footerText) {
              var footerSpan = document.querySelector('footer span');
              if (footerSpan) footerSpan.textContent = data.footerText;
            }
          });
        } catch(err) {
          console.warn('Firebase content load error:', err);
        }
      });
    });
  }

  // Load content when page is ready
  if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', loadSiteContent);
  } else {
    loadSiteContent();
  }
</script>

<script>
  function loadRecentMedia() {
    fetch('media.json')
      .then(function(res) { return res.json(); })
      .then(function(data) {
        var comics = data.comics || [];
        var drawings = data.drawings || [];
        
        // Sort by date (newest first)
        comics.sort(function(a, b) { return b.uploadedAt - a.uploadedAt; });
        drawings.sort(function(a, b) { return b.uploadedAt - a.uploadedAt; });

        // Show recent comics
        if (comics.length > 0) {
          var comicsHtml = '<div class="recent-grid>';
          for (var i = 0; i < Math.min(3, comics.length); i++) {
            comicsHtml += '<div class="recent-item"><p>' + comics[i].title + '</p><button onclick="openComicViewer(\'' + comics[i].url.replace(/'/g, "\\'") + '\')" style="padding: 8px 16px; border: 1px solid var(--border); background: var(--bg3); color: var(--accent); cursor: pointer; font-family: var(--font-mono); font-size: 12px; border-radius: 4px;">View</button></div>';
          }
          comicsHtml += '</div>';
          var comicsEl = document.getElementById('recent-comics');
          if (comicsEl) comicsEl.innerHTML = comicsHtml;
        }

        // Show recent drawings
        if (drawings.length > 0) {
          var drawingsHtml = '<div class="recent-grid>';
          for (var i = 0; i < Math.min(3, drawings.length); i++) {
            drawingsHtml += '<div class="recent-item"><p>' + drawings[i].title + '</p><a href="drawings.html" style="display: inline-block; padding: 8px 16px; border: 1px solid var(--border); background: var(--bg3); color: var(--accent); border-radius: 4px; font-size: 12px;">View</a></div>';
          }
          drawingsHtml += '</div>';
          var drawingsEl = document.getElementById('recent-drawings');
          if (drawingsEl) drawingsEl.innerHTML = drawingsHtml;
        }
      })
      .catch(function(err) {
        console.error('Error loading media:', err);
      });
  }

  function openComicViewer(pdfUrl) {
    var modal = document.getElementById('comic-modal');
    var iframe = document.getElementById('comic-iframe');
    iframe.src = 'pdf-viewer.html?url=' + encodeURIComponent(pdfUrl);
    modal.style.display = 'block';
  }

  function closeComicModal() {
    document.getElementById('comic-modal').style.display = 'none';
    document.getElementById('comic-iframe').src = '';
  }

  if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', loadRecentMedia);
  } else {
    loadRecentMedia();
  }
</script>

</content>
